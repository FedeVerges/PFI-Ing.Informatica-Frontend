<div
  class="container mt-2 animate__animated animate__fadeIn"
  *ngIf="!hasError; else error"
>
  <div class="row" *ngIf="successMessage.length <= 0; else certificateCreated">
    <div class="col">
      <h3 class="card-title">Crear Titulo</h3>
      <div class="row mt-2">
        <div class="col-sm-6 col-md-4">
          <mdb-form-control class="mb-3">
            <input
              mdbInput
              type="text"
              id="search_dni"
              class="form-control"
              [(ngModel)]="personDocNumber"
              (keyup.enter)="getStudentByDni()"
              [ngModelOptions]="{ standalone: true }"
            />
            <label mdbLabel class="form-label" for="search_dni"
              >N&uacute;mero de documento</label
            >
          </mdb-form-control>
        </div>

        <div class="col-sm-6 col-md-2">
          <button
            type="button"
            type="submit"
            [disabled]="!personDocNumber"
            class="btn btn-secondary"
            (click)="getStudentByDni()"
          >
            Buscar
          </button>
        </div>
      </div>
      <div
        class="container-fluid my-2"
        *ngIf="studentList && studentList.length > 0 && !studentSelected"
      >
        <div class="row">
          <div class="col-6">
            <h5 class="text-start">Graduados encontrados:</h5>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <div class="list-group list-group-light">
              <button
                type="button"
                class="list-group-item list-group-item-action btn my-2 text-start bg-primary secondary"
                *ngFor="let student of studentList"
                aria-current="true"
                mdbRipple
                (click)="selectStudent(student)"
              >
                {{ student.person.fullname }} - {{ student.degreeProgramName }}
              </button>
            </div>
          </div>
        </div>
      </div>

      <form
        autocomplete="true"
        [formGroup]="studentForm"
        *ngIf="studentSelected"
      >
        <div class="container">
          <div class="row">
            <div class="col-xs-12 col-md-4">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  class="form-control"
                  formControlName="name"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >Nombre</label
                >
              </mdb-form-control>
            </div>
            <div class="col-xs-12 col-md-4">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_lastName"
                  class="form-control"
                  formControlName="lastname"
                  required
                />
                <label mdbLabel class="form-label" for="form_lastName"
                  >Apellido</label
                >
              </mdb-form-control>
            </div>
            <div class="col-xs-12 col-md-4">
              <div class="mb-3">
                <select
                  class="form-select"
                  aria-label="gender select"
                  id="sexSelect"
                  formControlName="sex"
                  required
                >
                  <option selected value="">Elija el sexo</option>
                  <option value="Masculino">Masculino</option>
                  <option value="Femenino">Femenino</option>
                  <option value="Otro">Otro</option>
                </select>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12 col-md-6">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  maxlength="8"
                  class="form-control"
                  formControlName="docNumber"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >N° Documento</label
                >
              </mdb-form-control>
            </div>
            <div class="col-xs-12 col-md-6">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  maxlength="8"
                  class="form-control"
                  formControlName="registrationNumber"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >N° Registro</label
                >
              </mdb-form-control>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12 col-md-6">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  class="form-control"
                  formControlName="university"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >Universidad</label
                >
              </mdb-form-control>
            </div>
            <div class="col-xs-12 col-md-6">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  class="form-control"
                  formControlName="academicUnit"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >Unidad Acad&eacute;mica</label
                >
              </mdb-form-control>
            </div>
          </div>

          <div class="row">
            <div class="col-xs-12 col-md-3">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  class="form-control"
                  formControlName="degreeProgramName"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >Carrera</label
                >
              </mdb-form-control>
            </div>
            <div class="col-xs-12 col-md-3">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  class="form-control"
                  formControlName="degreeProgramCurriculum"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >Plan de estudios</label
                >
              </mdb-form-control>
            </div>
          </div>
        </div>
      </form>
      <form
        autocomplete="true"
        [formGroup]="certificateForm"
        *ngIf="studentSelected"
      >
        <div class="container">
          <h4 class="text-start mt-2 card-title">Datos del certificado</h4>
          <div class="row">
            <div class="col-xs-12 col-md-6">
              <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  class="form-control"
                  formControlName="waferNumber"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >N° Oblea</label
                >
              </mdb-form-control>
              <!-- <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  class="form-control"
                  formControlName="degreeName"
                  required
                  readonly
                />
                <label mdbLabel class="form-label" for="form_name"
                  >Nombre del t&iacute;tulo</label
                >
              </mdb-form-control> -->
            </div>
            <div class="col-xs-12 col-md-6">
              <select
                class="form-select"
                id="degreeTypeSelect"
                formControlName="degreeType"
                required
              >
                <option selected value="">Tipo de titulo</option>
                <option value="PREGRADO-GRADO">Pregrado - Grado</option>
                <option value="POSTGRADO">Posgrado</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div class="col-xs-12 col-md-6">
              <!-- <mdb-form-control class="mb-3">
                <input
                  mdbInput
                  type="text"
                  id="form_name"
                  class="form-control"
                  formControlName="waferNumber"
                  required
                />
                <label mdbLabel class="form-label" for="form_name"
                  >N° Oblea</label
                >
              </mdb-form-control> -->
            </div>
          </div>

          <div class="row">
            <div class="col text-end">
              <button
                type="button"
                type="submit"
                class="btn btn-light mx-2"
                (click)="clearForm()"
              >
                Limpiar
              </button>
              <button
                type="button"
                type="submit"
                class="btn btn-secondary"
                (click)="addNewCertificate()"
              >
                Crear título universitario
              </button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<ng-template #certificateCreated>
  <div class="container mt-2 animate__animated animate__slideInDown">
    <app-message
      [title]="successMessage"
      [message]="detailMessage"
      type="TRANSACTION"
    >
      <div class="mt-4">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="goToTransactionList()"
        >
          Listado de transacciones
        </button>
      </div>
    </app-message>
  </div>
</ng-template>

<ng-template #error>
  <div class="container mt-2 animate__animated animate__flipInX">
    <app-message
      title="Ha ocurrido un error al intentar cargar los datos"
      type="ERROR"
      message="Comuniquese con el administrador."
    ></app-message>
  </div>
</ng-template>
